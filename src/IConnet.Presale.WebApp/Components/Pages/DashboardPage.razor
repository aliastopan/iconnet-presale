@attribute [Route(PageRoute.Dashboard)]
@inherits DashboardPageBase
@rendermode @(InteractiveServer.DisablePreRender())

<PageTitle>Dashboard</PageTitle>

<AuthorizeView Policy="@Policies.AdministratorPrivilege"
    Context="AuthenticationContext">

    <Authorized>
        <FluentLabel Typo="Typography.H3" MarginBlock="0.5rem">Dashboard</FluentLabel>
        @* <span class="page-description">Laporan data Presale</span> *@

        <div>
            @if (MonthlyPresaleData is not null)
            {
                <FluentTabs ActiveTabId="tab-1">
                    <FluentTab Id="tab-1">
                        <Header>
                            <FluentIcon Value="@(new Icons.Regular.Size16.DocumentCheckmark())" Color="@Color.Accent"/>
                            Status Approval
                        </Header>
                        <Content>

                            <div>Presale Data: @MonthlyPresaleData.Count()</div>

                            <div style="margin-top: 8px;">
                                Data Presale bulan @CurrentMonth @CurrentYear
                            </div>
                            <ApprovalStatusReportTable Models="@MonthlyApprovalStatusReport"/>

                            <div style="margin-top: 8px;">
                                Data Presale minggu ke-@CurrentWeek bulan @CurrentMonth
                            </div>
                            <ApprovalStatusReportTable Models="@WeeklyApprovalStatusReport"/>


                            <div style="margin-top: 8px;">
                                Data Presale hari ini
                            </div>
                            <ApprovalStatusReportTable Models="@DailyApprovalStatusReport"/>

                        </Content>
                    </FluentTab>
                    <FluentTab Id="tab-2">
                        <Header>
                            <FluentIcon Value="@(new Icons.Regular.Size16.DocumentError())" Color="@Color.Accent"/>
                            Root Cause
                        </Header>
                        <Content>
                            <div style="margin-top: 8px;">
                                Root Cause @CurrentMonth @CurrentYear
                            </div>
                            <RootCauseReportTable Models="@MonthlyRootCauseReport"/>
                        </Content>
                    </FluentTab>
                    <FluentTab Id="tab-3">
                        <Header>
                            <FluentIcon Value="@(new Icons.Regular.Size16.Timer())" Color="@Color.Accent"/>
                            Aging Import
                        </Header>
                        <Content>
                            <div style="margin-top: 8px;">
                                Aging PAC Import bulan @CurrentMonth @CurrentYear
                            </div>
                            <ImportAgingReportTable Models="@MonthlyImportAgingReport"/>
                        </Content>
                    </FluentTab>
                    <FluentTab Id="tab-4">
                        <Header>
                            <FluentIcon Value="@(new Icons.Regular.Size16.Timer())" Color="@Color.Accent"/>
                            Aging Verifikasi
                        </Header>
                        <Content>
                            <div style="margin-top: 8px;">
                                Aging PAC iCRM+ verifikasi bulan @CurrentMonth @CurrentYear
                            </div>
                            <VerificationAgingReportTable Models="@MonthlyVerificationAgingReport"/>
                        </Content>
                    </FluentTab>
                </FluentTabs>
            }
            else
            {
                <div class="d-flex flex-row align-items-center">
                    <span class="px-1">Loading</span>
                    <FluentProgressRing style="width: 16px; height: 16px;"></FluentProgressRing>
                </div>
            }
        </div>

    </Authorized>

    <NotAuthorized>
        <AccessDenied />
    </NotAuthorized>

</AuthorizeView>

