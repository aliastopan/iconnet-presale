<div>
    @if (Models is not null)
    {
        <div class="@_wrapperCss" style="border-bottom: none !important;">
            <table class="root-cause-tabulation" style="width: fit-content;">
                <thead>
                    <tr>
                        <th rowspan="2" class="tabulation-header" style="">
                            ROOT CAUSE
                        </th>
                        <th colspan="@Models.SelectMany(m => m.RootCausePerOffice.Keys).Distinct().Count()"
                            class="tabulation-header"
                            style="">
                            Kantor Perwakilan
                        </th>
                        <th rowspan="2" class="tabulation-header" style="">
                            Grand Total
                        </th>
                    </tr>
                    <tr>
                        @foreach (var office in Models.SelectMany(m => m.RootCausePerOffice.Keys).Distinct())
                        {
                            <th class="tabulation-header-secondary" style="padding: 2px 8px; text-align: center;">
                                @office
                            </th>
                        }
                    </tr>
                </thead>
                <tbody class="tabulation-body">
                    @foreach (var model in Models)
                    {
                        <tr>
                            <td class="tabulation-header-row" style="width: 325px">@model.RootCause</td>
                            @foreach (var office in Models.SelectMany(m => m.RootCausePerOffice.Keys).Distinct())
                            {
                                <td class="tabulation-content" style="width: 100px">
                                @if (model.RootCausePerOffice.ContainsKey(office))
                                {
                                    @model.RootCausePerOffice[office]
                                }
                                else
                                {
                                    <span>-</span>
                                }
                                </td>
                            }
                            <td class="tabulation-content" style="width: 125px">
                                @model.GrandTotal
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
        <div class="tabulation-summary">
            <table>
                <tbody>
                    <tr>
                        <td class="tabulation-header" style="width: 325px">Grand Total</td>
                        @foreach (var office in Models.SelectMany(m => m.RootCausePerOffice.Keys).Distinct())
                        {
                            <td class="tabulation-content" style="width: 100px">
                                @Models.Sum(m => m.RootCausePerOffice.GetValueOrDefault(office, 0))
                            </td>
                        }
                        <td class="tabulation-content-summary" style="width: 125px">
                            @Models.Sum(m => m.GrandTotal)
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    }
</div>

@code
{
    private string _wrapperCss => IsPageView
        ? "tabulation-wrapper-page-view"
        : "tabulation-wrapper";
}