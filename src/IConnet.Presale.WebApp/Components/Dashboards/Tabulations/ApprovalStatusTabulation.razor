@using IConnet.Presale.WebApp.Models.Presales.Reports

@if (Models is not null)
{
    <table class="approval-status-tabulation" style="@GetChartWidthStyle()">
        <thead>
            <tr>
                <th class="tabulation-header" style="height: 24px !important;">
                    Status
                </th>
                @foreach (var office in Models.SelectMany(m => m.StatusPerOffice.Keys).Distinct())
                {
                    <th class="tabulation-header" style="padding: 2px 8px; text-align: center; height: 24px !important;">
                        @office
                    </th>
                }
                <th class="tabulation-header" style="height: 24px !important;">
                    Grand Total
                </th>
            </tr>
        </thead>
        <tbody>
            @foreach (var model in Models)
            {
                <tr>
                    <td class="tabulation-header-row" style="height: 24px !important;">
                        @model.ApprovalStatusDisplay
                    </td>
                    @foreach (var office in Models.SelectMany(m => m.StatusPerOffice.Keys).Distinct())
                    {
                        <td class="tabulation-content" style="height: 24px !important;">
                        @if (model.StatusPerOffice.ContainsKey(office))
                        {
                            @model.StatusPerOffice[office]
                        }
                        else
                        {
                            <span>-</span>
                        }
                        </td>
                    }
                    <td class="tabulation-content" style="height: 24px !important;">
                        @model.GrandTotal
                    </td>
                </tr>
            }
            <tr>
                <td class="tabulation-header" style="height: 24px !important;">
                    Grand Total
                </td>
                @foreach (var office in Models.SelectMany(m => m.StatusPerOffice.Keys).Distinct())
                {
                    <td class="tabulation-content" style="height: 24px !important;">
                        @Models.Sum(m => m.StatusPerOffice.GetValueOrDefault(office, 0))
                    </td>
                }
                <td class="tabulation-content-summary" style="height: 24px !important;">
                    @Models.Sum(m => m.GrandTotal)
                </td>
            </tr>
        </tbody>
    </table>
}
