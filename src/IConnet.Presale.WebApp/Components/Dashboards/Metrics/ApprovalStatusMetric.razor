@using ApexCharts
@using IConnet.Presale.WebApp.Models.Presales.Reports

@if (Models.Count != 0)
{
    <ApexChart TItem="ApprovalStatusMetricModel"
        Height="300"
        Width="600"
        Options="Options">

        @foreach (var approvalStatus in Models.First().Status.Keys)
        {
            <ApexPointSeries TItem="ApprovalStatusMetricModel"
                Items="Models"
                Name="@EnumProcessor.EnumToDisplayString(approvalStatus)"
                XValue="@(e => e.Office)"
                SeriesType="SeriesType.Bar"
                YAggregate="@(Metrics => Metrics.Sum(x => x.Status[approvalStatus]))"
                ShowDataLabels/>
        }

    </ApexChart>
}
