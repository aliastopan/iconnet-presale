@using ApexCharts
@using IConnet.Presale.WebApp.Models.Presales.Reports

@if (Metrics.Count != 0)
{
    <ApexChart TItem="ApprovalStatusMetricModel"
        Height="350"
        Width="800"
        Options="Options">

        @foreach (var approvalStatus in Models.Select(m => m.ApprovalStatus).Distinct())
        {
            <ApexPointSeries TItem="ApprovalStatusMetricModel"
                Items="Metrics"
                Name="@EnumProcessor.EnumToDisplayString(approvalStatus)"
                XValue="@(e => e.Office)"
                SeriesType="SeriesType.Bar"
                YAggregate="@(Metrics => Metrics.Sum(x => x.Status[approvalStatus]))"/>
        }

    </ApexChart>
}
